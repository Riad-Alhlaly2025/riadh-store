{% extends 'store/base.html' %}
{% load static %}

{% block title %}سجل الطلبات الفاخر - متجر رياض الإلكتروني{% endblock %}

{% block content %}
<div class="luxury-dashboard">
    <!-- Header Section -->
    <div class="dashboard-header luxury-card animated fadeInDown">
        <div class="header-content">
            <div class="user-greeting">
                <h1 class="welcome-title">سجل <span class="highlight">الطلبات</span></h1>
                <p class="last-login">إدارة جميع طلباتك السابقة والحالية</p>
            </div>
            <div class="header-stats">
                <div class="stat-badge">
                    <i class="fas fa-shopping-bag"></i>
                    <span class="stat-label">إجمالي الطلبات</span>
                    <span class="stat-value">{{ orders|length }}</span>
                </div>
                <div class="stat-badge">
                    <i class="fas fa-check-circle"></i>
                    <span class="stat-label">الطلبات المكتملة</span>
                    <span class="stat-value">24</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Filter Section -->
    <div class="filter-section luxury-card animated fadeInUp">
        <div class="filter-header">
            <h3><i class="fas fa-filter"></i> تصفية الطلبات</h3>
        </div>
        <div class="filter-content">
            <div class="filter-row">
                <div class="filter-item">
                    <label for="status-filter">حالة الطلب</label>
                    <select id="status-filter" class="luxury-select">
                        <option value="">جميع الحالات</option>
                        <option value="pending">قيد الانتظار</option>
                        <option value="processing">قيد المعالجة</option>
                        <option value="shipped">تم الشحن</option>
                        <option value="delivered">تم التسليم</option>
                        <option value="cancelled">ملغى</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label for="date-filter">نطاق التاريخ</label>
                    <select id="date-filter" class="luxury-select">
                        <option value="">آخر 30 يوم</option>
                        <option value="7">آخر 7 أيام</option>
                        <option value="30">آخر 30 يوم</option>
                        <option value="90">آخر 90 يوم</option>
                        <option value="365">آخر سنة</option>
                    </select>
                </div>
                <div class="filter-item">
                    <button class="luxury-btn primary">تطبيق الفلاتر</button>
                    <button class="luxury-btn secondary">إعادة تعيين</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Orders List -->
    <div class="orders-section">
        <div class="section-header">
            <h2 class="section-title animated fadeInUp">جميع الطلبات</h2>
        </div>
        
        {% if orders %}
        <div class="orders-grid">
            {% for order in orders %}
            <div class="order-card luxury-card animated fadeInUp" data-delay="{{ forloop.counter0|mul:0.1 }}">
                <div class="order-header">
                    <div class="order-info">
                        <h3>طلب #{{ order.pk }}</h3>
                        <span class="order-date">{{ order.created_at|date:"d/m/Y H:i" }}</span>
                    </div>
                    <div class="order-status-badge status-{{ order.status }}">
                        {{ order.get_status_display }}
                    </div>
                </div>
                
                <div class="order-details">
                    <div class="detail-row">
                        <div class="detail-item">
                            <span class="label">عدد العناصر:</span>
                            <span class="value">{{ order.items.count }}</span>
                        </div>
                        <div class="detail-item">
                            <span class="label">المبلغ الإجمالي:</span>
                            <span class="value amount">{{ order.total_amount }} 
                                {% if order.currency == 'USD' %}USD
                                {% elif order.currency == 'EUR' %}EUR
                                {% elif order.currency == 'SAR' %}ر.س
                                {% elif order.currency == 'AED' %}د.إ
                                {% elif order.currency == 'EGP' %}ج.م
                                {% elif order.currency == 'KWD' %}د.ك
                                {% elif order.currency == 'QAR' %}ر.ق
                                {% elif order.currency == 'OMR' %}ر.ع.
                                {% elif order.currency == 'BHD' %}د.ب
                                {% elif order.currency == 'JOD' %}د.أ
                                {% else %}{{ order.currency }}
                                {% endif %}
                            </span>
                        </div>
                    </div>
                    
                    <div class="detail-row">
                        <div class="detail-item">
                            <span class="label">طريقة الدفع:</span>
                            <span class="value">بطاقة ائتمان</span>
                        </div>
                        <div class="detail-item">
                            <span class="label">طريقة التوصيل:</span>
                            <span class="value">توصيل سريع</span>
                        </div>
                    </div>
                </div>
                
                <div class="order-actions">
                    <a href="{% url 'order_detail' order.pk %}" class="luxury-btn primary">عرض التفاصيل</a>
                    <button class="luxury-btn secondary">تتبع الشحنة</button>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="empty-orders luxury-card animated fadeInUp">
            <div class="empty-content">
                <i class="fas fa-inbox empty-icon"></i>
                <h3>لا توجد طلبات</h3>
                <p>ليس لديك أي طلبات حالياً.</p>
                <a href="{% url 'home' %}" class="luxury-btn primary">ابدأ التسوق الآن</a>
            </div>
        </div>
        {% endif %}
    </div>
    
    <!-- Order Summary -->
    <div class="order-summary luxury-card animated fadeInUp">
        <div class="summary-header">
            <h3><i class="fas fa-chart-pie"></i> ملخص الطلبات</h3>
        </div>
        <div class="summary-content">
            <div class="summary-item">
                <div class="summary-icon pending">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="summary-text">
                    <h4>قيد الانتظار</h4>
                    <p class="summary-value">3</p>
                </div>
            </div>
            <div class="summary-item">
                <div class="summary-icon processing">
                    <i class="fas fa-cog"></i>
                </div>
                <div class="summary-text">
                    <h4>قيد المعالجة</h4>
                    <p class="summary-value">5</p>
                </div>
            </div>
            <div class="summary-item">
                <div class="summary-icon shipped">
                    <i class="fas fa-truck"></i>
                </div>
                <div class="summary-text">
                    <h4>تم الشحن</h4>
                    <p class="summary-value">8</p>
                </div>
            </div>
            <div class="summary-item">
                <div class="summary-icon delivered">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="summary-text">
                    <h4>تم التسليم</h4>
                    <p class="summary-value">24</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
// Enhanced animations
document.addEventListener('DOMContentLoaded', function() {
    // Add staggered animations
    const animatedElements = document.querySelectorAll('.animated');
    animatedElements.forEach((el, index) => {
        const delay = el.dataset.delay || 0;
        setTimeout(() => {
            el.style.opacity = 1;
            el.style.transform = 'translateY(0)';
        }, parseFloat(delay) * 1000 || 0);
    });
    
    // Filter functionality
    const statusFilter = document.getElementById('status-filter');
    const dateFilter = document.getElementById('date-filter');
    
    if (statusFilter) {
        statusFilter.addEventListener('change', function() {
            // Filter logic would go here
            console.log('Status filter changed to:', this.value);
        });
    }
    
    if (dateFilter) {
        dateFilter.addEventListener('change', function() {
            // Filter logic would go here
            console.log('Date filter changed to:', this.value);
        });
    }
});
</script>
{% endblock %}